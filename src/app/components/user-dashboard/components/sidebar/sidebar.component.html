<div class="sidebar flex flex-col w-64 bg-primary-purple text-white fixed h-full z-20 md:static transition-transform duration-300 ease-in-out" 
     [ngClass]="{'-translate-x-full': !(isSidebarOpen$ | async) && isMobile, 'translate-x-0': (isSidebarOpen$ | async) || !isMobile}" 
     *ngIf="isLoggedIn$ | async">
  <div class="flex items-center justify-between h-16 px-4 border-b border-dark-purple">
    <div class="flex items-center space-x-2">
      <i class="ri-parking-box-fill text-gold-500 text-2xl"></i>
      <span class="text-xl font-bold font-display">Parkiny</span>
    </div>
    <button class="md:hidden text-white" (click)="toggleSidebar()">
      <i class="ri-close-line text-xl"></i>
    </button>
  </div>
  <div class="flex flex-col flex-grow p-4 overflow-auto">
    <nav class="space-y-1">
      <div class="mt-6">
        <p class="px-3 text-xs font-semibold text-gray-300 uppercase tracking-wider">Navigation</p>
        <a routerLink="/dashboard" routerLinkActive="bg-dark-purple text-white" [routerLinkActiveOptions]="{ exact: true }" 
           class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-300 hover:bg-dark-purple hover:text-white mt-2 transition-colors">
          <i class="ri-dashboard-fill mr-3 text-gold-500"></i>
          Tableau de bord
        </a>
        <a routerLink="/dashboard/reservations" routerLinkActive="bg-dark-purple text-white" 
           class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-300 hover:bg-dark-purple hover:text-white mt-1 transition-colors">
          <i class="ri-calendar-check-fill mr-3 text-gold-500"></i>
          Réservations
        </a>
        <a routerLink="/dashboard/subscriptions" routerLinkActive="bg-dark-purple text-white" 
           class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-300 hover:bg-dark-purple hover:text-white mt-1 transition-colors">
          <i class="ri-bill-fill mr-3 text-gold-500"></i>
          Abonnements
        </a>
        <a routerLink="/dashboard/profile" routerLinkActive="bg-dark-purple text-white" 
           class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-300 hover:bg-dark-purple hover:text-white mt-1 transition-colors">
          <i class="ri-user-fill mr-3 text-gold-500"></i>
          Profil
        </a>
        <a routerLink="/dashboard/spot-status" routerLinkActive="bg-dark-purple text-white" 
           class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-300 hover:bg-dark-purple hover:text-white mt-1 transition-colors">
          <i class="ri-road-map-fill mr-3 text-gold-500"></i>
          Statut des places
        </a>
        <a routerLink="/dashboard/notifications" routerLinkActive="bg-dark-purple text-white" 
           class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-300 hover:bg-dark-purple hover:text-white mt-1 transition-colors">
          <i class="ri-notification-3-fill mr-3 text-gold-500"></i>
          Notifications
        </a>
        <a routerLink="/dashboard/language" routerLinkActive="bg-dark-purple text-white" 
           class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-300 hover:bg-dark-purple hover:text-white mt-1 transition-colors">
          <i class="ri-global-fill mr-3 text-gold-500"></i>
          Langue
        </a>
        <a routerLink="/dashboard/support" routerLinkActive="bg-dark-purple text-white" 
           class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-300 hover:bg-dark-purple hover:text-white mt-1 transition-colors">
          <i class="ri-question-fill mr-3 text-gold-500"></i>
          Support
        </a>
        <a (click)="logout()" class="flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-300 hover:bg-dark-purple hover:text-white mt-4 cursor-pointer transition-colors">
          <i class="ri-logout-box-r-line mr-3 text-gold-500"></i>
          Déconnexion
        </a>
      </div>
    </nav>
  </div>
  <div class="p-4 border-t border-dark-purple">
    <div class="flex items-center">
      <div class="w-10 h-10 rounded-full bg-dark-purple text-gold-500 flex items-center justify-center text-sm font-medium gold-glow">
        {{ userInitials || 'UN' }}
      </div>
      <div class="ml-3">
        <p class="text-sm font-medium text-white">{{ userName || 'Utilisateur' }}</p>
        <p class="text-xs font-medium text-gray-300">{{ subscriptionType || 'Membre' }}</p>
      </div>
    </div>
  </div>
</div>

<button *ngIf="(isLoggedIn$ | async) && (isMobile$ | async) && !(isSidebarOpen$ | async)" (click)="toggleSidebar()" 
        class="md:hidden fixed top-4 left-4 z-30 text-primary-purple bg-gold-500 p-2 rounded-md">
  <i class="ri-menu-line text-xl"></i>
</button>